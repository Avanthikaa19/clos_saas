<div class="main-container">
    <div class="header-container">
        Configuration:-
    </div>
    <div class="content-container">

        <div class="card-container flex-row-parent">
            <div class="card-inner-container flex-stetch">
                <span>
                    Choose
                </span>
            </div>
            <div class="flex-stetch">
                &nbsp; &nbsp;
            </div>
            <ng-container>
                <ng-container>
                    <div class="flex-unstetch" style="margin-left: 1rem; margin-right: 1rem;">
                        <mat-select class="min-select" [(value)]="name" (selectionChange)="onValueSelected($event.value)" #multiSelect1>
                            <mat-option *ngFor="let data of params" [value]="data">
                                {{data.name}}
                            </mat-option>
                        </mat-select>
                    </div>
                </ng-container>
            </ng-container>
        </div>

        <!-- Main Container  -->

        <ng-container *ngFor="let configJson of configData; let i=index;">
            <div class="header-container details-header">
                <span style="padding-left: 1rem;">
                    Result Column {{i + 1}} :-
                </span>
                <span style="float: right;" (click)="this.configData.splice(i,1)">
                    <mat-icon style="color: red;font-size: 1.4rem; cursor: pointer; margin-right: 0rem;">remove
                    </mat-icon>
                </span>
            </div>
            <div class="card-container flex-row-parent">
                <div class="card-inner-container flex-stetch">
                    <span>
                        Var Name
                    </span>
                </div>
                <div class="flex-stetch">
                    &nbsp; &nbsp;
                </div>
                <ng-container>
                    <ng-container>
                        <div class="flex-unstetch" style="margin-left: 1rem; margin-right: 1rem;">
                            <input class="min-input" [(ngModel)]="configJson.name">
                        </div>
                    </ng-container>
                </ng-container>
            </div>
            <ng-container *ngFor="let config of configJson.configMethod">
                <div class="card-container flex-row-parent">
                    <div class="card-inner-container flex-stetch">
                        <span>
                            {{config.name}}
                        </span>
                    </div>
                    <div class="flex-stetch">
                        &nbsp; &nbsp;
                    </div>
                    <ng-container *ngIf="config">
                        <ng-container *ngIf="config.output">
                            <div class="flex-unstetch" style="margin-left: 1rem;">
                                <mat-select class="min-select" [(ngModel)]="config.input" style="text-transform: capitalize;" #multiSelect1>
                                    <ng-container *ngIf="config.name != 'calc'">
                                        <mat-option>
                                            <ngx-mat-select-search placeholderLabel="Find column..." ngModel (ngModelChange)="filterColumns($event)" noEntriesFoundLabel='No columns match search criteria.'>
                                            </ngx-mat-select-search>
                                        </mat-option>
                                        <mat-option *ngFor="let columns of filteredColumns" [value]="columns.name">
                                            {{columns.name}}
                                        </mat-option>
                                    </ng-container>
                                    <ng-container *ngIf="config.name == 'calc'">
                                        <mat-option *ngFor="let columns of calcArray" [value]="columns" style="text-transform: capitalize;">
                                            {{columns}}
                                        </mat-option>
                                    </ng-container>
                                </mat-select>
                            </div>
                        </ng-container>
                    </ng-container>

                    <!-- Filter By  -->

                    <ng-container *ngIf="config.name == 'rowFilter'">
                        <div class="flex-stetch" style="margin-left: 1rem; min-width: 10rem; margin-right: 1rem;">
                            <mat-select class="min-select" [(ngModel)]="config.filterSymbol" style="text-transform: capitalize;" #multiSelect1>
                                <ng-container>
                                    <mat-option>
                                        <ngx-mat-select-search placeholderLabel="Find column..." ngModel (ngModelChange)="filterColumns($event)" noEntriesFoundLabel='No columns match search criteria.'>
                                        </ngx-mat-select-search>
                                    </mat-option>
                                    <mat-option [value]="">
                                        None
                                    </mat-option>
                                    <mat-option *ngFor="let columns of filterSymbols" [value]="columns">
                                        {{columns}}
                                    </mat-option>
                                </ng-container>
                            </mat-select>
                        </div>
                        <div class="flex-stetch" style="margin-left: 1rem; min-width: 20rem; margin-right: 1rem;">
                            <input class="min-input" [(ngModel)]="config.filterValue">
                        </div>
                    </ng-container>


                    <!-- <ng-container *ngIf="config.name == 'columnFilter'">
                        <div class="flex-stetch" style="margin-left: 1rem; min-width: 20rem; margin-right: 1rem;">
                            <mat-select class="min-select" [(ngModel)]="config.groupCol"
                                style="text-transform: capitalize;" #multiSelect1>
                                <ng-container>
                                    <mat-option>
                                        <ngx-mat-select-search placeholderLabel="Find column..." ngModel
                                            (ngModelChange)="filterColumns($event)"
                                            noEntriesFoundLabel='No columns match search criteria.'>
                                        </ngx-mat-select-search>
                                    </mat-option>
                                    <mat-option [value]="''">
                                        None
                                    </mat-option>
                                    <mat-option *ngFor="let columns of filteredColumns" [value]="columns.name">
                                        {{columns.name}}
                                    </mat-option>
                                </ng-container>
                            </mat-select>
                        </div>
                    </ng-container> -->

                    <!-- Group By  -->

                    <!-- <ng-container *ngIf="config.name == 'groupBy'">
                        <div class="flex-stetch" style="margin-left: 1rem; min-width: 20rem; margin-right: 1rem;">
                            <mat-select class="min-select" [(ngModel)]="config.groupCol"
                                style="text-transform: capitalize;" #multiSelect1>
                                <ng-container>
                                    <mat-option>
                                        <ngx-mat-select-search placeholderLabel="Find column..." ngModel
                                            (ngModelChange)="filterColumns($event)"
                                            noEntriesFoundLabel='No columns match search criteria.'>
                                        </ngx-mat-select-search>
                                    </mat-option>
                                    <mat-option [value]="''">
                                        None
                                    </mat-option>
                                    <mat-option *ngFor="let columns of filteredColumns" [value]="columns.name">
                                        {{columns.name}}
                                    </mat-option>
                                </ng-container>
                            </mat-select>
                        </div>
                    </ng-container> -->

                    <!-- Calculation  -->

                    <ng-container *ngIf="config.name == 'calc'">
                        <div class="flex-stetch" style="margin-left: 1rem; min-width: 20rem; margin-right: 1rem;">
                            <mat-select class="min-select" [(ngModel)]="config.calcValue" style="text-transform: capitalize;" #multiSelect1>
                                <ng-container>
                                    <mat-option [value]="">
                                        None
                                    </mat-option>
                                    <mat-option *ngFor="let columns of calcValues" [value]="columns" style="text-transform: capitalize;">
                                        {{columns}}
                                    </mat-option>
                                </ng-container>
                            </mat-select>
                        </div>
                    </ng-container>

                    <div class="flex-stetch" *ngIf="config.name != 'calc'">
                        <button style="margin-left: 1rem; background-color: whitesmoke; border: 0px;" matTooltip="Add" [matTooltipPosition]="'above'">
                            <mat-icon style="margin-right: 0rem; color: red; cursor: pointer;" (click)="config.output.push(getPushData(config.input ,config.filterSymbol , config.filterValue, config.calcValue)); 
                                config.input=''; config.filterSymbol=''; config.filterValue=''; config.calcValue=''">
                                add</mat-icon>
                        </button>
                    </div>

                </div>
                <div class="card-container flex-property-parent" *ngIf="config.name != 'calc'">
                    <div class="card-inner-container flex-stetch" *ngFor="let output of config.output; let i = index" style="margin-left: 1rem; text-transform: capitalize;">
                        <span>
                            {{output}}
                        </span>
                        <mat-icon style="float: right; color: red; font-size: 1.4rem; margin-right: 0rem; cursor: pointer;" (click)="config.output.splice(i,1)" matTooltip="Remove" [matTooltipPosition]="'above'">
                            remove</mat-icon>
                    </div>
                </div>
            </ng-container>
        </ng-container>
        <div class="flex-row-parent" style="margin-top: 1rem;">
            <div class="flex-stetch">
            </div>
            <div class="flex-stetch">
                <button mat-stroked-button (click)="this.configData.push({name: '',configMethod:[{name: 'groupBy',input: '', output: []},
                {name: 'columnFilter',input: '',output: []},
                {name: 'rowFilter',input: '',output: []},
                {name: 'calc',input: '',output: []}]})">
                    <mat-icon>add</mat-icon>
                    <span>
                        Add
                    </span>
                </button>
            </div>

        </div>
    </div>
</div>

<mat-dialog-actions align="end">
    <button mat-stroked-button mat-dialog-close style="color: red;">
        <mat-icon>close</mat-icon>Close
    </button>
    <button mat-raised-button style="color: white;background-color: rgb(43, 42, 42);" (click)="onSaveClick()" cdkFocusInitial>
        <mat-icon>save</mat-icon>Save
    </button>
</mat-dialog-actions>